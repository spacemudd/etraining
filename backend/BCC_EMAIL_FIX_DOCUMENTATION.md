# ุฅุตูุงุญ ูุดููุฉ BCC Emails - ุงูุชูุซูู ุงููุงูู

## ๐ฏ ุงููุดููุฉ
ูุงูุช ููุงู ูุดููุฉ ูู ุนุฏู ูุตูู ุฌููุน ุงูุงููููุงุช ุงููุฑุณูุฉ ูู BCC ุจุดูู ุตุญูุญุ ุญูุซ:
- ุจุนุถ ุงูุงููููุงุช ุชุตู ูุงูุฃุฎุฑู ูุง ุชุตู
- ูุนุงูุฌุฉ ุบูุฑ ุตุญูุญุฉ ููุงููููุงุช ุงููุงุฑุบุฉ ุฃู null
- ุฏูุฌ CC ู BCC ูู ูุตูููุฉ ูุงุญุฏุฉ
- ุงุณุชุฎุฏุงู `bcc()` ูุฑุชูู ููุง ูุณุจุจ ุชุถุงุฑุจ

## ๐ง ุงูุญููู ุงููุทุจูุฉ

### 1. ุฅุตูุงุญ CompanyResignationsController
**ุงูููู:** `app/Http/Controllers/Back/CompanyResignationsController.php`

**ุงููุดููุฉ ุงูุณุงุจูุฉ:**
```php
$emails_cc = $resignation->emails_cc ? explode(', ', $resignation->emails_cc) : null;
$emails_bcc = $resignation->emails_bcc ? explode(', ', $resignation->emails_bcc) : null;
$emails = array_merge($emails_cc, $emails_bcc);
Mail::to($resignation->emails_to ? explode(', ', $resignation->emails_to) : null)
    ->bcc($emails)
    ->send(new ResignationsMail($resignation));
```

**ุงูุญู ุงูุฌุฏูุฏ:**
- ูุนุงูุฌุฉ ูููุตูุฉ ููู ููุน ุฅูููู (TO, CC, BCC)
- ุชุญูู ูู ุตุญุฉ ุงูุงููููุงุช ุจุงุณุชุฎุฏุงู `filter_var()`
- ุฅุฒุงูุฉ ุงููุณุงูุงุช ุงูุฒุงุฆุฏุฉ
- ูุนุงูุฌุฉ ุงูุญุงูุงุช ุงูุฎุงุตุฉ (ุนุฏู ูุฌูุฏ TO emails)

### 2. ุฅุตูุงุญ CompanyAttendanceReportController
**ุงูููู:** `app/Http/Controllers/Back/CompanyAttendanceReportController.php`

**ุงููุดููุฉ ุงูุณุงุจูุฉ:**
```php
Mail::to($report->emails_to()->pluck('email') ?: null)
    ->bcc($report->emails_cc()->pluck('email') ?: null)
    ->send(new CompanyAttendanceReportMail($report->id));
```

**ุงูุญู ุงูุฌุฏูุฏ:**
- ูุนุงูุฌุฉ ุตุญูุญุฉ ููู Collections
- ุชุตููุฉ ุงูุงููููุงุช ุงููุงุฑุบุฉ
- ุชุญูู ูู ุตุญุฉ ุงูุงููููุงุช

### 3. ุฅุตูุงุญ CompanyAttendanceReportService
**ุงูููู:** `app/Services/CompanyAttendanceReportService.php`

**ุงููุดููุฉ ุงูุณุงุจูุฉ:**
```php
Mail::to($report->emails_to()->pluck('email') ?: null)
    ->bcc($report->emails_cc()->pluck('email') ?: null)
    ->bcc($report->emails_bcc()->pluck('email') ?: null)  // ูุดููุฉ: bcc() ูุฑุชูู
    ->send(new CompanyAttendanceReportMail($report->id));
```

**ุงูุญู ุงูุฌุฏูุฏ:**
- ูุนุงูุฌุฉ ูููุตูุฉ ูู CC ู BCC
- ุฅุฒุงูุฉ ุงูุชุถุงุฑุจ ูู ุงุณุชุฎุฏุงู `bcc()`

## ๐๏ธ ุงููููุงุช ุงูุฌุฏูุฏุฉ ุงููุถุงูุฉ

### 1. EmailHelper Class
**ุงูููู:** `app/Helpers/EmailHelper.php`

ุฏุงูุฉ ููุญุฏุฉ ููุนุงูุฌุฉ ูุฅุฑุณุงู ุงูุงููููุงุช:
```php
EmailHelper::sendEmail([
    'to' => 'user@example.com',
    'cc' => 'cc@example.com',
    'bcc' => 'bcc1@example.com,bcc2@example.com'
], $mailClass, 'Context Name');
```

**ุงููููุฒุงุช:**
- ูุนุงูุฌุฉ ููุญุฏุฉ ูุฌููุน ุฃููุงุน ุงูุงููููุงุช
- ุชุญูู ูู ุตุญุฉ ุงูุงููููุงุช
- ุชุณุฌูู ููุตู ููุนูููุงุช
- ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก

### 2. SendBulkEmailJob
**ุงูููู:** `app/Jobs/SendBulkEmailJob.php`

Job ูุฅุฑุณุงู ุงูุงููููุงุช ุงููุจูุฑุฉ ูู ุฏูุนุงุช:
```php
SendBulkEmailJob::dispatch($emailData, $mailClass, 'Context', 10);
```

**ุงููููุฒุงุช:**
- ุชูุณูู ุงูุงููููุงุช ุงููุจูุฑุฉ ุฅูู ุฏูุนุงุช
- ุฅุนุงุฏุฉ ุงููุญุงููุฉ ูู ุญุงูุฉ ุงููุดู
- ุชุฃุฎูุฑ ุจูู ุงูุฏูุนุงุช ูุชุฌูุจ rate limiting

### 3. Email Settings Config
**ุงูููู:** `config/email_settings.php`

ุฅุนุฏุงุฏุงุช ูุงุจูุฉ ููุชุฎุตูุต:
```php
'max_recipients_per_email' => 50,
'delay_between_emails' => 1,
'enable_detailed_logging' => true,
```

## ๐ ุงูุชุญุณููุงุช ุงููุทุจูุฉ

### 1. ูุนุงูุฌุฉ ุงูุงููููุงุช
- โ ุชุญูู ูู ุตุญุฉ ุงูุงููููุงุช ุจุงุณุชุฎุฏุงู `filter_var()`
- โ ุฅุฒุงูุฉ ุงููุณุงูุงุช ุงูุฒุงุฆุฏุฉ
- โ ุชุตููุฉ ุงูุงููููุงุช ุงููุงุฑุบุฉ
- โ ูุนุงูุฌุฉ ุงูุญุงูุงุช ุงูุฎุงุตุฉ (null, empty string)

### 2. ุฅุฑุณุงู ุงูุงููููุงุช
- โ ูุนุงูุฌุฉ ูููุตูุฉ ูู TO, CC, BCC
- โ ุงุณุชุฎุฏุงู ุฃูู BCC ูู TO ูู ุญุงูุฉ ุนุฏู ูุฌูุฏ TO
- โ ุฅุถุงูุฉ ูู BCC ุจุดูู ูููุตู ุจุงุณุชุฎุฏุงู loop

### 3. ุงูุชุณุฌูู ูุงููุฑุงูุจุฉ
- โ ุชุณุฌูู ููุตู ูุนุฏุฏ ุงููุณุชูููู
- โ ุชุณุฌูู ุงูุงููููุงุช ุงููุฑุณูุฉ
- โ ุชุณุฌูู ุงูุฃุฎุทุงุก ูุน ุงูุชูุงุตูู

### 4. ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก
- โ ุฑุณุงุฆู ุฎุทุฃ ูุงุถุญุฉ
- โ ูุนุงูุฌุฉ ุงูุงุณุชุซูุงุกุงุช
- โ ุฅุนุงุฏุฉ ุงููุญุงููุฉ ูู ุงูู Jobs

## ๐งช ููููุฉ ุงูุงุฎุชุจุงุฑ

### 1. ุงุฎุชุจุงุฑ ุฅุฑุณุงู ุงูุงุณุชูุงูุงุช
```bash
# ูุฑุงูุจุฉ ุงูู logs
tail -f storage/logs/laravel.log | grep -i "resignation"
```

### 2. ุงุฎุชุจุงุฑ ุชูุงุฑูุฑ ุงูุญุถูุฑ
```bash
# ูุฑุงูุจุฉ ุงูู logs
tail -f storage/logs/laravel.log | grep -i "attendance"
```

### 3. ุงุฎุชุจุงุฑ ุงูุงููููุงุช ุงููุชุนุฏุฏุฉ
- ุฃุถู ุนุฏุฉ ุงููููุงุช ูู BCC ููุตููุฉ ุจูุงุตูุฉ
- ุชุฃูุฏ ูู ูุตูู ุฌููุน ุงูุงููููุงุช

## ๐ ุงููุชุงุฆุฌ ุงููุชููุนุฉ

### ูุจู ุงูุฅุตูุงุญ:
- โ ุจุนุถ BCC emails ูุง ุชุตู
- โ ุฃุฎุทุงุก ุนูุฏ ูุฌูุฏ ุงููููุงุช ูุงุฑุบุฉ
- โ ุนุฏู ูุถูุญ ุณุจุจ ูุดู ุงูุฅุฑุณุงู

### ุจุนุฏ ุงูุฅุตูุงุญ:
- โ ุฌููุน BCC emails ุชุตู ุจุดูู ุตุญูุญ
- โ ูุนุงูุฌุฉ ุตุญูุญุฉ ููุงููููุงุช ุงููุงุฑุบุฉ
- โ ุชุณุฌูู ููุตู ููุนูููุงุช
- โ ุฑุณุงุฆู ุฎุทุฃ ูุงุถุญุฉ
- โ ุฅููุงููุฉ ุฅุฑุณุงู ุงููููุงุช ูุจูุฑุฉ ูู ุฏูุนุงุช

## ๐ ุงูุงุณุชุฎุฏุงู ุงููุณุชูุจูู

ููุงุณุชูุงุฏุฉ ูู ุงูุญููู ุงูุฌุฏูุฏุฉ ูู ุฃุฌุฒุงุก ุฃุฎุฑู ูู ุงููุธุงู:

```php
// ุงุณุชุฎุฏุงู EmailHelper
use App\Helpers\EmailHelper;

$result = EmailHelper::sendEmail([
    'to' => 'user@example.com',
    'cc' => 'cc1@example.com,cc2@example.com',
    'bcc' => 'bcc1@example.com,bcc2@example.com'
], new YourMailClass(), 'Your Context');

// ุงุณุชุฎุฏุงู Job ููุงููููุงุช ุงููุจูุฑุฉ
use App\Jobs\SendBulkEmailJob;

SendBulkEmailJob::dispatch($emailData, $mailClass, 'Context', 10);
```

## ๐จ ููุงุญุธุงุช ูููุฉ

1. **ุชุฃูุฏ ูู ุชุดุบูู Queue Worker** ููู Jobs:
   ```bash
   php artisan queue:work
   ```

2. **ูุฑุงูุจุฉ ุงูู Logs** ููุชุงุจุนุฉ ุงูุนูููุงุช:
   ```bash
   tail -f storage/logs/laravel.log
   ```

3. **ุงุฎุชุจุงุฑ ุงูุงููููุงุช** ูู ุจูุฆุฉ ุงูุชุทููุฑ ูุจู ุงูุฅูุชุงุฌ

4. **ุชุญุฏูุซ ุฅุนุฏุงุฏุงุช ุงูุจุฑูุฏ ุงูุฅููุชุฑููู** ูู `.env` ุฅุฐุง ูุฒู ุงูุฃูุฑ
