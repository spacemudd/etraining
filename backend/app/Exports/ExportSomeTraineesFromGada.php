<?php

namespace App\Exports;

use App\Models\Back\Trainee;
use Maatwebsite\Excel\Concerns\FromCollection;
use Maatwebsite\Excel\Concerns\WithHeadings;
use Carbon\Carbon;

class ExportSomeTraineesFromGada implements FromCollection, WithHeadings
{
    public function collection()
    {
        $idNumbers=[
           '1087953590',
          '1068633112',
          '1106540030',
          '1098899998',
          '1111174445',
          '1071303224',
          '1106987488',
          '1092559911',
          '1096338163',
          '1051561882',
          '1098389750',
          '1094036561',
          '1123591578',
          '1084419330',
          '1035860491',
          '1120894439',
          '1035819265',
          '1034847002',
          '1097936957',
          '1080214875',
          '1075427367',
          '1111931216',
          '1120892581',
          '1000888287',
          '1133711463',
          '1110099536',
          '1131907113',
          '1051277000',
          '1123767244',
          '1076459187',
          '1094969548',
          '1101101168',
          '1022476111',
          '1105313488',
          '1049917287',
          '1060057906',
          '1115473512',
          '1114318460',
          '1105446932',
          '1090327998',
          '1099819912',
          '1084896800',
          '1025816412',
          '1124361153',
          '1120806649',
          '1072503582',
          '1096857394',
          '1098879214',
          '1102672209',
          '1121307795',
          '1117639078',
          '1120020191',
          '١٠٤٩٥٩٨٧٠٧',
          '1116504794',
          '1066967926',
          '1119215521',
          '1093525507',
          '1090432483',
          '1109746691',
          '1127018834',
          '1124610864',
          '1017026434',
          '1059909844',
          '1116953181',
          '1118393949',
          '1109513422',
          '1105087322',
          '1118199551',
          '1108804095',
          '1090122142',
          '1090786045',
          '1125128486',
          '1096966641',
          '1102280896',
          '1131485391',
          '1118616562',
          '1091043289',
          '1113659666',
          '1055154247',
          '1023425919',
          '1068400231',
          '1108735307',
          '1056057365',
          '1091740462',
          '1113433732',
          '1132117019',
          '1084456753',
          '1077479796',
          '1095618854',
          '1086813647',
          '1094485784',
          '1118402500',
          '1116763127',
          '1095701023',
          '1078968581',
          '1041256676',
          '1105999716',
          '1093569026',
          '1072284464',
          '1133155489',
          '1127456703',
          '1091582443',
          '1085171526',
          '1083294965',
          '1045121405',
          '1105681561',
          '1087975700',
          '1114948100',
          '1056951633',
          '1046554281',
          '1077709424',
          '1213812728',
          '1121228397',
          '1136776331',
          '1086288022',
          '1060080767',
          'ترغب بتقديم', استقاله
          '1123372409',
          '1102634456',
          '1137522106',
          '1135373635',
          '1116932102',
          '1114422296',
          '1136992086',
          '1059001626',
          '1087323299',
          '1037113105',
          '1073288381',
          '1076143211',
          '1077245460',
          '1122215997',
          '1057171561',
          '1099882910',
          '1070290562',
          '1043213469',
          '1118067063',
          '1091982049',
          '1096525314',
          '1103708119',
          '1075191369',
          '1041880236',
          '1057313338',
          '1107269910',
          '1087637524',
          '1105786444',
          '1107588426',
          '1104264831',
          '1108426832',
          '1111546485',
          '1087280374',
          '1029562160',
          '1016085431',
          '1036292025',
          '1132121516',
          '1036742607',
          '1075446292',
          '1091974202',
          '1075867174',
          '1105205510',
          '1071756488',
          '1087830699',
          '1064154386',
          '1107417428',
          '1076375904',
          '1089182321',
          '1077208658',
          '١١٠١٦٧٠٣٩٤',
          '1074276989',
          '1054202492',
          '1123636076',
          '1097231474',
          '1063470262',
          '1064711060',
          '1028194510',
          '١٠٥٨٥٦٠٩١١',
          '1109663755',
          '1086058136',
          '1086029723',
          '1088958960',
          '1023278433',
          '١٠٨٦١٥١٤٤٤',
          '1075923142',
          '1054988553',
          '1087362685',
          '1100278678',
          '1100466703',
          '1035022670',
          '1060316740',
          '1085200317',
          '1111472153',
          '1125771855',
          '1065629923',
          '١٠٣٤٥٩٠٦٣٦',
          '1098806332',
          '1114781428',
          '1068821972',
          '1095894778',
          '1122748435',
          '1066709286',
          '1122567645',
          '1045271341',
          '1097987893',
          '1073463299',
          '1087919161',
          '1115288340',
          '1127581666',
          '1100853199',
          '1065146563',
          '1128824446',
          '1091667384',
          '1103236624',
          '1128464680',
          '1111973499',
          '1089888000',
          '1133311041',
          '1127387817',
          '1092256450',
          '1073958504',
          '1086180252',
          '1097194896',
          '1082652726',
          '1090745546',
          '1120442627',
          '1110380480',
          '1086943428',
          '1126306453',
          '1004203129',
          '1044983219',
          '1085592796',
          '1089743882',
          '1083317683',
          '1126589744',
          '1084939675',
          '1088196348',
          '1108130087',
          '1089534794',
          '1061936579',
          '1066148576',
          '1125417707',
          '١١٠٢٦٢٠٦٤٦',
          '1097203903',
          '1009661412',
          '1104158157',
          '1124618834',
          '1075765246',
          '1084830890',
          '1097134454',
          '1129974836',
          '1134833977',
          '1095757686',
          '1085116547',
          '1123860148',
          '1089461238',
          '1079181614',
          '1110473269',
          '1104708894',
          '1108934819',
          '1073286716',
          '1131523480',
          '1109469799',
          '1075224871',
          '1047825854',
          '1093232468',
          '1123215772',
          '1129354286',
          '1006117509',
          '1115099747',
          '١٠٧٥٦٦٩٨٢٨',
          '1121209124',
          '1091539443',
          '1088719594',
          '1002424388',
          '1099269290',
          '1079313647',
          '1086423702',
          '1066617596',
          '١٠٨٣١٩٣٥٤٨',
          '1132014448',
          '1113785305',
          '1080216219',
          '1085850665',
          '1121645343',
          '1077980868',
          '1114157256',
          '1120774235',
          '1113745002',
          '1117397404',
          '1103019772',
          '1118228863',
          '1098159989',
          '1085859849',
          '1058204924',
          '1070429996',
          '1077817581',
          '1100925773',
          '1130902685',
          '1106364662',
          '1099472258',
          '1093033296',
          '1024845404',
          '1060700729',
          '1001585080',
          '1020567416',
          '1066651595',
          '1090177443',
          '1090852466',
          '1090842327',
          '1100424850',
          '1088341076',
          '1082496827',
          '1072374778',
          '1122647306',
          '1071976326',
          '1014074551',
          '1122295627',
          '1039423304',
          '١٠٩١٨٨١١٩١',
          '1029787486',
          '1127374674',
          '1101834156',
          '1093562757',
          '1058065036',
          '1085793089',
          '1119717484',
          '١٠٦٩٠٠٨٤٤٧',
          '1097815821',
          '1109774727',
          '1095648570',
          '1050206778',
          '1070459951',
          '1087103253',
          '1126173432',
          '1113403909',
          '1089524308',
          '1108944180',
          '1094067160',
          '1111961858',
          '1123678771',
          '1058780899',
          '1088347578',
          '1020634984',
          '1117416303',
          '1114085523',
          '1097727117',
          '1119262259',
          '1110112834',
          '١٠٠١٩٤٩٨١٥',
          '1059828721',
          '1049374836',
          '1096998917',
        ];

        $trainees = Trainee::onlyTrashed()
        ->whereIn('identity_number', $idNumbers)
        ->with('company') // لازم تجيب العلاقة لو بتستخدمها
        ->get();
    

        return $trainees->map(function ($trainee) {
            return [
                'name' => $trainee->name,
                'identity_number' => $trainee->identity_number,
                'email' => $trainee->email,
                'phone' => $trainee->phone,
                'company' => $trainee->company->name_ar ?? '-', // لو ما في شركة يظهر "-"
                // 'last_login_at' => optional($trainee->user)->last_login_at ?? '-',
            ];
        });
    }

    public function headings(): array
    {
        return [
            'الإسم',
            'الهوية',
            'الإيميل',
            'الجوال',
            'الشركة',
            'تاريخ آخر دخول',
        ];
    }
}
