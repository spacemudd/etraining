<?php

namespace App\Exports;

use App\Models\Back\Trainee;
use Maatwebsite\Excel\Concerns\FromCollection;
use Maatwebsite\Excel\Concerns\WithHeadings;
use Carbon\Carbon;

class ExportSomeTraineesFromGada implements FromCollection, WithHeadings
{
    public function collection()
    {
        $idNumbers=[
            '1114128562',
            '1067218402',
            '1106199498',
            '1083553048',
            '1097372179',
            '1119061255',
            '1081911032',
            '1115636043',
            '1113608028',
            '١١٠٩٥٩٧٣٥٩',
            '1075040772',
            '1120806656',
            '1108866771',
            '1051277000',
            '1123767244',
            '1094969548',
            '1101101168',
            '1105313488',
            '1049917287',
            '1060057906',
            '1091043289',
            '1055154247',
            '1023425919',
            '1093569026',
            '1072284464',
            '١٠٢٨٢٩٢٦٠٣',
            '1085171526',
            '1098920927',
            '1083294965',
            '1045121405',
            '1114948100',
            '1121228397',
            '1086029723',
            '1098806332',
            '1127387817',
            '1126306453',
            '1085592796',
            '1083317683',
            '1066148576',
            '1115473512',
            '1114318460',
            '1105446932',
            '1106040817',
            '1123372409',
            '1103236624',
            '1070459951',
            '1118384880',
            '1079775498',
            '1044671715',
            '1104582851',
            '1092628005',
            '1120560675',
            '1085760823',
            '1101076550',
            '1099412965',
            '1092470325',
            '1087953590',
            '1068633112',
            '1106540030',
            '1098899998',
            '1111174445',
            '1071303224',
            '1106987488',
            '1092559911',
            '1096338163',
            '1098389750',
            '1094036561',
            '1084419330',
            '1035860491',
            '1120894439',
            '1099819912',
            '1073775965',
            '1137522106',
            '1087323299',
            '1076143211',
            '1125417707',
            '1108934819',
            '١٠٨٣١٩٣٥٤٨',
            '1113785305',
            '1077980868',
            '1113745002',
            '1058204924',
            '1066651595',
            '1090177443',
            '1118199551',
            '1055940694',
            '1073286716',
            '1051561882',
            '1123591578',
            '1100609807',
            '1068196292',
            '1120587694',
            '1084219375',
            '1109864072',
            '1085495040',
            '1125581551',
            '1135648952',
            '1096872096',
            '1082265123',
            '1085132767',
            '1208545770',
            '1092696697',
            '1070560782',
            '1103214811',
            '1089546343',
            '1035819265',
            '1034847002',
            '1097936957',
            '1080214875',
            '1081981845',
            '1075427367',
            '1111931216',
            '1120892581',
            '1133711463',
            '1110099536',
            '1022476111',
            '1120020191',
            '1093525507',
            '1017026434',
            '1109513422',
            '1131485391',
            '1077479796',
            '1103708119',
            '1041880236',
            '1104264831',
            '1029562160',
            '1036292025',
            '1075446292',
            '1105205510',
            '1107417428',
            '١١٠١٦٧٠٣٩٤',
            '1074276989',
            '1023278433',
            '1054988553',
            '1087362685',
            '1111472153',
            '1128464680',
            '1097194896',
            '1090745546',
            '1110380480',
            '1097203903',
            '1084830890',
            '1104708894',
            '1109469799',
            '1123215772',
            '1129354286',
            '1006117509',
            '1088719594',
            '1085850665',
            '1121645343',
            '1093033296',
            '1100424850',
            '1088341076',
            '1014074551',
            '١٠٩١٨٨١١٩١',
            '1119717484',
            '1117416303',
            '1070674302',
            '1118402500',
            '1084939675',
            '1089534794',
            '1061936579',
            '1009661412',
            '1124618834',
            '1132522044',
            '1133434629',
            '1095981732',
            '1089687337',
            '1095233506',
            '1028770269',
            '1091898567',
            '1035011244',
            '1075109247',
            '1091904316',
            '1065098137',
            '1089948358',
            '١١٠٦٧٥٦٢٢٢',
            '1111426266',
            '1127900544',
            '1092335619',
            '1103592075',
            '1123446377',
            '1142458262',
            '1131569830',
            '1094824206',
            '1098475278',
            '1093811659',
            '1089715542',
            '1087318810',
            '1045276464',
            '1117723278',
            '1037646302',
            '1081791186',
            '1079575179',
            '1109850774',
            '1059853646',
            '1091887479',
            '1070767080',
            '1091318376',
            '1097460560',
            '1026579886',
            '1116932102',
            '1075920999',
            '1079313647',
            '1000888287',
            '1090327998',
            '1084896800',
            '1120806649',
            '1072503582',
            '1096857394',
            '1098879214',
            '1102672209',
            '1117639078',
            '١٠٤٩٥٩٨٧٠٧',
            '1116504794',
            '1066967926',
            '1119215521',
            '1109746691',
            '1127018834',
            '1124610864',
            '1059909844',
            '1116953181',
            '1118393949',
            '1105087322',
            '1108804095',
            '1090122142',
            '1090786045',
            '1102280896',
            '1102280896',
            '1113659666',
            '1068400231',
            '1113433732',
            '1132117019',
            '1084456753',
            '1094485784',
            '1091582443',
            '1105681561',
            '1062231285',
            '1114422296',
            '1059001626',
            '1037113105',
            '1073288381',
            '١١١٠٥٣٤٥٨١',
            '1057171561',
            '1043213469',
            '1118067063',
            '1057313338',
            '1132121516',
            '1060316740',
            '١٠٣٤٥٩٠٦٣٦',
            '1073958504',
            '1126589744',
            '1075765246',
            '1129974836',
            '1095757686',
            '1075224871',
            '1080216219',
            '1114157256',
            '1117397404',
            '1118228863',
            '1098159989',
            '1070429996',
            '1024845404',
            '1060700729',
            '1001585080',
            '1082496827',
            '1122295627',
            '1093562757',
            '1058065036',
            '1097815821',
            '1109774727',
            '1108944180',
            '1123678771',
            '1020634984',
            '1097727117',
            '١٠٠١٩٤٩٨١٥',
        ];

        $trainees = Trainee::withTrashed()->whereIn('identity_number', $idNumbers)
        ->where('zoho_contract_status','completed')
        ->get();
    

        return $trainees->map(function ($trainee) {
            return [
                'name' => $trainee->name,
                'identity_number' => $trainee->identity_number,
                'email' => $trainee->email,
                'phone' => $trainee->phone,
                'company' => $trainee->company->name_ar ?? '-', // لو ما في شركة يظهر "-"
                // 'last_login_at' => optional($trainee->user)->last_login_at ?? '-',
            ];
        });
    }

    public function headings(): array
    {
        return [
            'الإسم',
            'الهوية',
            'الإيميل',
            'الجوال',
            'الشركة',
            // 'تاريخ آخر دخول',
        ];
    }
}
