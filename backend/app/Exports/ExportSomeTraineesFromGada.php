<?php

namespace App\Exports;

use App\Models\Back\Trainee;
use Maatwebsite\Excel\Concerns\FromCollection;
use Maatwebsite\Excel\Concerns\WithHeadings;
use Carbon\Carbon;


class ExportSomeTraineesFromGada implements FromCollection, WithHeadings
{
    public function collection()
    {

        $traineesNumbers = [
                '0533881902',
                '0509523855',
                '0553251009',
                '0556860754',
                '0531111351',
                '0535546637',
                '0558086027',
                '0551460490',
                '0530986060',
                '0569333847',
                '0500136138',
                '0502529946',
                '0536151270',
                '0503061249',
                '0508332641',
                '0501228422',
                '0506893118',
                '0553293407',
                '0550773238',
                '0554307882',
                '0503373205',
                '0560580562',
                '0531233898',
                '0501877197',
                '0542903566',
                '0583229300',
                '0533849742',
                '0503241945',
                '0583421070',
                '0550494777',
                '0558520175',
                '0548569611',
                '0564425772',
                '0567898856',
                '0569984232',
                '0502369466',
                '0553630667',
                '0559781820',
                '0546226935',
                '0505488512',
                '0538534978',
                '0551835282',
                '0551090082',
                '0533602315',
                '0599617726',
                '0550805176',
                '0532570400',
                '0547403035',
                '555972601',
                '0506273387',
                '0531243852',
                '0537855720',
                '0535487720',
                '500157252',
                '0538443134',
                '0535072257',
                '0551516994',
                '0551736451',
                '0555369454',
                '0550229854',
                '501352673',
                '0551176233',
                '0537476763',
                '0559917226',
                '0557104479',
                '0541755054',
                '507409475',
                '0503092277',
                '0556349993',
                '0503372653',
                '0509188705',
                '0551457759',
                '508416489',
                '0542004275',
                '0558090407',
                '0505591024',
                '0506115756',
                '0591134729',
                '0532063635',
                '0549991358',
                '0580740567',
                '0595066366',
                '0555666887',
                '0551869206',
                '0537707772',
                '0556783660',
                '0553132765',
                '0507331760',
                '0556712324',
                '0557181791',
                '0530862319',
                '0558380113',
                '0555778640',
                '0506529988',
                '547519544',
                '0550101621',
                '544061933',
                '0554553012',
                '0507655441',
                '0538909571',
                '0553860544',
                '0503220196',
                '0556052090',
                '0540855769',
                '0559913176',
                '0536911944',
                '0597770626',
                '0559747244',
                '0505883824',
                '0545213655',
                '0534432195',
                '0549191782',
                '0500597663',
                '0544931973',
                '0558400069',
                '0534521153',
                '0503430234',
                '0532617259',
                '0505743842',
                '0508506149',
                '0554832927',
                '0556276973',
                '0532565202',
                '0541081654',
                '0507817004',
                '0566604234',
                '0556080129',
                '507700798',
                '0534606591',
                '0536764231',
                '0508705644',
                '0531932801',
                '0544996750',
                '0566081084',
                '0508540711',
                '0550088257',
                '0507703497',
                '0548331150',
                '0533400339',
                '0559113319',
                '0590739546',
                '0508828493',
                '0568670008',
                '0553760713',
                '0537101065',
                '0536562543',
                '0597422062',
                '0501555282',
                '0593033605',
                '0530795203',
                '0568052314',
                '0548885821',
                '0503708420',
                '0505633865',
                '0533132250',
                '0504847136',
                '0533602261',
                '0533061516',
                '0503082939',
                '0556454402',
                '0553318402',
                '0504398643',
                '0558808212',
                '0555102086',
                '0550871119',
                '0556595435',
                '0549047181',
                '0535917918',
                '0536970300',
                '0552608995',
                '0557264944',
                '0532448401',
                '0549320683',
                '0530392928',
                '0559305300',
                '0540512833',
                '566093810',
                '0566099227',
                '0538802111',
                '0501868441',
                '0532536072',
                '0501716229',
                '0537155369',
                '0507586582',
                '0552185583',
                '0556052524',
                '0555610435',
                '0553694090',
                '0567169807',
                '0558514665',
                '0566697794',
                '0554796359',
                '0551974176',
                '0505809241',
                '0538940931',
                '0505419154',
                '0537409707',
                '0547714574',
                '0503732140',
                '0551572756',
                '0545673432',
                '0503479299',
                '0553320646',
                '٠٥٥٤٧٥٩٦٨٢',
                '0550786422',
                '507101358',
                '0500626314',
                '0505257914',
                '0535276765',
                '0560307373',
                '0557041733',
                '0557335273',
                '0508537611',
                '0580289424',
                '0536215351',
                '0583604641',
                '0563896152',
                '0550681668',
                '٠٥٦٢٦٦١٤٠٥',
                '0557034035',
                '552851320',
                '0554596880',
                '0552914324',
                '0531207363',
                '0535295357',
                '0550402523',
                '0554626127',
                '0567624369',
                '0550487677',
                '0501893214',
                '٠٥٥٨٠٨٤١٣٥',
                '0501030220',
                '0533722594',
                '539090214',
                '0532026169',
                '0534223268',
                '0503256114',
                '0562435646',
                '0558252311',
                '547871384',
                '0552225816',
                '0536084753',
                '0559214042',
                '0557196760',
                '0541673556',
                '0530942050',
                '0558020626',
                '0538689223',
                '0557795720',
                '0559680588',
                '0538828851',
                '0558268622',
                '0505888538',
                '0557464473',
                '0506695506',
                '0501668260',
                '0555462745',
                '0550422269',
                '0536958773',
                '0536543578',
                '0534293695',
                '0531991791',
                '0558961766',
                '0531154915',
                '0537211163',
                '0501622406',
                '0506475527',
                '0530005347',
                '0507541739',
                '0558820902',
                '0508858321',
                '0550086517',
                '0536827696',
                '0556869271',
                '0551246213',
                '0500498287',
                '0501447437',
                '0551557712',
                '0580141367',
                '0541916313',
                '0542893381',
                '0508859498',
                '0505767140',
                '0541489744',
                '0552994175',
                '0548718475',
                '0539141686',
                '0500721144',
                '0530638042',
                '0540247321',
                '0536307215',
                '0506568986',
                '0552228384',
                '538281271',
                '0532075750',
                '0559047279',
                '0505463462',
                '0500588101',
                '0501058656',
                '0559280081',
                '0506429442',
                '0562101097',
                '٠٥٥٣٨٣٨٤٢٩',
                '0538703370',
                '0563035832',
                '0563377201',
                '0530882030',
                '0599197683',
                '0590065611',
                '502785041',
                '0533479442',
                '0593132286',
                '0501548406',
                '0553519970',
                '0507879154',
                '0555256004',
                '0500266588',
                '0530871651',
                '0544211707',
                '0531562423',
                '0535923916',
                '0501001923',
                '0502920918',
                '0507015777',
                '0552263085',
                '0532401820',
                '0532119372',
                '0562171305',
                '0582662412',
                '0549784601',
                '0502531560',
                '0501556457',
                '0508310541',
                '0559000816',
                '557392735',
                '0504355769',
                '0533405459',
                '0555316590',
                '0507457237',
                '0557761754',
                '0508253321',
                '0557077631',
                '0566344766',
                '0561990038',
                '0557314023',
                '0555998576',
                '0532888632',
                '0500653453',
                '0507907591',
                '0557259954',
                '0505694384',
                '0545424253',
                '0557295284',
                '0531403148',
                '0559721335',
                '0533936339',
                '0538304586',
                '0502935280',
                '0501411375',
                '0558250952',
                '0547421475',
                '597937223',
                '0532624279',
                '0550860181',
                '0533298337',
                '0559669587',
                '0554048059',
                '0507209631',
                '0504662288',
                '0559104465',
                '0508451544',
                '0553660628',
                '0557467539',
                '0506904109',
                '0561055842',
                '0541458388',
                '0562648958',
                '0530011569',
                '0552455970',
                '0503141322',
                '0537223356',
                '٠٥٣٤٧٦٨٧١٦',
                '0507879952',
                '0500758023',
                '535378993',
                '0506639253',
                '0501023837',
                '0559936083',
                '0531152735',
                '0551818160',
                '0556386517',
                '0505369639',
                '0533560895',
                '0531117211',
                '0555838724',
                '541933192',
                '0503508274',
                '0538272535',
                '0502832024',
                '0558732487',
                '0502310887',
                '0550860323',
                '0552258114',
                '0556897745',
                '0594891104',
                '0505313397',
                '0531977667',
                '0544749642',
                '0557693908',
                '0500875372',
                '0550189326',
                '0551692242',
                '0500909289',
                '0508560061',
                '0558411178',
                '0535076351',
                '0532470446',
                '0534628439',
                '0507838411',
                '0545051419',
                '0542796648',
                '0595991148',
                '0548324707',
                '0508547830',
                '0539419941',
                '0546811266',
                '0555332159',
                '565075782',
                '0559615903',
                '0580461884',
                '0533069836',
                '0568032647',
                '0530548285',
                '0562040986',
                '501566844',
                '0506422292',
                '558435335',
                '0531178328',
                '0538554887',
                '0537074412',
                '558910604',
                '0533500275',
                '0543720620',
                '0501198964',
                '0535816673',
                '0507639471',
                '0507701273',
                '0500337364',
                '0538023280',
                '0504698626',
                '0542052437',
                '0504986268',
                '0556162315',
                '0530491735',
                '0554588131',
                '0538037720',
                '0535050727',
                '0509255029',
                '0565388875',
                '0551338140',
                '0538411444',
                '0537526284',
                '0537452070',
                '0536948364',
                '0535787868',
                '0509234284',
                '0552234422',
                '0531268831',
                '0536261655',
                '0507106087',
                '0530461411',
                '0553136421',
                '0555044132',
                '0547921788',
                '0558264877',
                '0531312744',
                '0554333461',
                '0508556862',
                '0532845818',
                '0552980153',
                '0558497507',
                '0549260450',
                '0500282751',
                '0593125738',
                '0540030909',
                '0569485252',
                '0536620435',
                '0545039452',
                '0532706889',
                '0533870796',
                '0598500255',
                '0561748666',
                '0544596699',
                '0533464852',
                '0556318490',
                '0560291896',
                '0535352157',
                '0537069674',
                '0509303955',
                '0551965964',
                '0553003835',
                '0567826152',
                '0530085620',
                '0569692898',
                '0547789958',
                '0500892254',
                '0554941652',
                '0500481770',
                '536437398',
                '0569918860',
                '532404895',
                '0509568013',
                '0566812002',
                '0532149162',
                '0501757556',
                '0501372846',
                '0553528170',
                '0506947442',
                '0534457440',
                '0509766545',
                '0532618518',
                '0531677249',
                '0569373722',
                '0530874440',
                '0538258669',
                '0504413248',
                '0566221905',
                '0554413591',
                '0554085120',
                '0508374570',
                '0500271124',
                '0550103681',
                '0558777453',
                '0551392397',
                '0596999711',
                '532989247',
                '0505229697',
                '0540244627',
                '0536614005',
                '0533721407',
                '0557308203',
                '٠٥٥٠٧٩٥٤١٢',
                '0564770620',
                '0552023820',
                '0553302334',
                '0534273472',
                '0557668737',
                '0538119922',
                '0561806759',
                '535645430',
                '0543161242',
                '0537669599',
                '0505225795',
                '0545291722',
                '0550172861',
                '0546036775',
                '0599664418',
                '0504266778',
                '0501966030',
                '0551505346',
                '0502556250',
                '0502333160',
                '0556602183',
                '0537661917',
                '0559573787',
                '0509765315',
                '0554124960',
                '0503897511',
                '0569997471',
                '0555817483',
                '0501284723',
                '0533090057',
                '0553305299',
                '0506051927',
                '0502592938',
                '0535367505',
                '0502631459',
                '0500390664',
                '0533404419',
                '0504466579',
                '0501876869',
                '0564060268',
                '0506957692',
                '0542535513',
                '0536558437',
                '0506958629',
                '0506088275',
                '0533139834',
                '0503843255',
                '0509566632',
                '0558189858',
                '0542534371',
                '0536003738',
                '0502474493',
                '0552815521',
                '0504554018',
                '0533241250',
                '563009734',
                '0533849503',
                '0591046013',
                '0502873262',
                '580713629',
                '551660636',
                '0562269135',
                '559633145',
                '0531887769',
                '0570394511',
                '0562851648',
                '0508319611',
                '0509005320',
                '0556989800',
                '0500828945',
                '0507313714',
                '0590719099',
                '0536700209',
                '0530374960',
                '0556454263',
                '0561504880',
                '0560399609',
                '0557169214',
                '0530809580',
                '0581918145',
                '0555848349',
                '0534290743',
                '507511636',
                '0563070371',
                '0506251688',
                '0557756595',
                '0540502820',
                '0531403640',
                '0599110931',
                '0551032811',
                '0503989119',
                '0558361732',
                '0553890174',
                '0551887987',
                '0500726511',
                '0583782699',
                '0597139991',
                '0508765445',
                '0549205548',
                '0561666017',
                '0543499451',
                '0537509775',
                '0532507752',
                '0508811531',
                '0502291325',
                '0532031070',
                '0507355506',
                '0599991185',
                '566294524',
                '0535068491',
                '0506813262',
                '0562545811',
                '0507511636',
                '0538530616',
                '0550022006',
                '0558124068',
                '0537051658',
                '0531380866',
                '0540207664',
                '0501041719',
                '0544924886',
                '0509631020',
                '0566320263',
                '0503989507',
                '0536075530',
                '0554526978',
                '0509990847',
                '0509143001',
                '0535230538',
                '0530516523',
                '0500086910',
                '547156935',
                '0544231821',
                '0540810702',
                '0532304372',
                '0537446272',
                '0556936251',
                '0557478469',
                '0592192239',
                '0553956698',
                '0561260582',
                '0534909519',
                '0554862635',
                '0506037663',
                '0503668248',
                '0531990339',
                '0535432388',
                '0555892557',
                '0553773231',
                '0533510910',
                '0538710829',
                '0552136582',
                '0504771102',
                '0554855367',
                '0507289276',
                '0504113039',
                '0538941873',
                '0509315552',
                '0531102167',
                '0552422496',
                '0580413795',
                '0560778820',
                '0563358792',
                '0533880243',
                '0531991165',
                '535320535',
                '0504489359',
                '0536260204',
                '0551500223',
                '0537422039',
                '0500556918',
                '0560092806',
                '0548491848',
                '0533368515',
                '0534477230',
                '0504413425',
                '0502544005',
                '0500803470',
                '0552781483',
                '0502261120',
                '0505539282',
                '0537602325',
                '0581344743',
                '0509626501',
                '0552708254',
                '0536069616',
                '0541181740',
                '0537339398',
                '537067513',
                '0555974974',
                '0532675089',
                '0562702474',
                '0533578803',
                '0556841098',
                '0532767235',
                '0505201227',
                '0556368257',
                '0542328628',
                '0508377075',
                '0504406749',
                '0566070100',
                '0582271514',
                '0536339047',
                '568590562',
                '0505497535',
                '0549331635',
                '0566889825',
                '0563453212',
                '0501561364',
                '0562795203',
                '0501323983',
                '0552754221',
                '0505591585',
                '0542388441',
                '0500074881',
                '0536155706',
                '0561337138',
                '0591116608',
                '0543039774',
                '0550716661',
                '0557724668',
                '0598310484',
                '0531577368',
                '0534767558',
                '0500821707',
                '0503676497',
                '0557305334',
                '0557665782',
                '0553789273',
                '0533954767',
                '0557109143',
                '544111417',
                '0533416855',
                '565798920',
                '0558616512',
                '0509373725',
                '0509021479',
                '0561216660',
                '0549525827',
                '0559575184',
                '0505870200',
                '0559955154',
                '0501538066',
                '0570133018',
                '598242828',
                '0547553139',
                '547065785',
                '0561988975',
                '550601719',
                '0535430225',
                '0530318663',
                '0533232657',
                '559135579',
                '0531962661',
                '0550489454',
                '0546671655',
                '0505583215',
                '0530648635',
                '0509490857',
                '0550692050',
                '0548004210',
                '0564818179',
                '506808856',
                '0531292949',
                '0501091621',
                '0565385677',
                '0532233895',
                '0556293438',
                '0537683747',
                '0533203615',
                '0552226242',
                '0568861469',
                '0593788660',
                '0532807436',
                '0564362801',
                '0508035647',
                '0565651918',
                '543649249 ',
                '0546698817',
                '0530538039',
                '0568816621',
                '0583335936',
                '0530402217',
                '0544228954',
                '0540676689',
                '0506144293',
                '0548168851',
                '0554994370',
                '0552699074',
                '0559661085',
                '0553601345',
                '0566725385',
                '536145369' ,
                '0558861567',
                '0599314850',
                '0538893676',
                '0538959838',
                '0502829059',
                '0599521063',
                '0501403612',
                '0532782522',
                '0500427993',
                '0546351386',
                '0559175447',
                '0504282731',
                '0509622791',
                '0556358997',
                '0509701714',
                '0553224660',
                '0533234319',
        ];



        return Trainee::whereIn('phone',$traineesNumbers)
            ->get(['name', 'phone', 'identity_number', 'email', 'city_id']) 
            ->map(function ($trainee) {
                return [
                    'city' => $trainee->city?->name_ar ?? 'لا يوجد',
                    'email' => $trainee->email,
                    'identity_number' => $trainee->identity_number,
                    'phone' => $trainee->clean_phone,
                    'name' => $trainee->name,
                ];
            });
        // return Trainee::whereDoesntHave('company')
        //     ->get(['name', 'phone', 'identity_number', 'email', 'city_id']) 
        //     ->map(function ($trainee) {
        //         return [
        //             'city' => $trainee->city?->name_ar ?? 'لا يوجد',
        //             'email' => $trainee->email,
        //             'identity_number' => $trainee->identity_number,
        //             'phone' => $trainee->clean_phone,
        //             'name' => $trainee->name,
        //         ];
        //     });
    }

    public function headings(): array
    {
        return [
            'المنطقة',
            'الإيميل',
            'رقم الهوية',
            'رقم الجوال',
            'الإسم'
        ];
    }
}

